<ion-header [translucent]="true">
  <ion-toolbar>
      <ion-segment [value]="segment">
          <ion-segment-button value="input" id="input" (click)="showInput()">
              <ion-label>{{ "calculator.form.title" | translate }}</ion-label>
          </ion-segment-button>
          <ion-segment-button value="results" id="results" (click)="showResult()">
              <ion-label>{{ "calculator.result-header" | translate }}</ion-label>
          </ion-segment-button>
      </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Tab 1</ion-title>
    </ion-toolbar>
  </ion-header>

    <ion-card *ngIf="segment === 'input'">
        <ion-card-header>
            <ion-card-title>{{ "calculator.form.title" | translate }}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
            <form [formGroup]="calculatorForm">
                <ion-range
                        aria-label="Custom range"
                        [min]="1"
                        [max]="100"
                        [value]="5"
                        [pin]="true"
                        [ticks]="true"
                        [snaps]="true"
                        formControlName="years"
                ></ion-range>
                {{ "calculator.form.interval" | translate }}: {{ getYears() }}
                ({{ "calculator.form.until" | translate }} {{ getUntilYear() }})

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.initialInvestment" | translate }}'
                               type="number"
                               formControlName="initialInvestment"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.initialDividends" | translate }}'
                               type="number"
                               formControlName="initialDividends"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.initialPriceGains" | translate }}'
                               type="number"
                               formControlName="initialPriceGains"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.priceGainPercentage" | translate }}'
                               type="number"
                               formControlName="priceGainPercentage"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.yearlyInvestment" | translate }}'
                               type="number"
                               formControlName="yearlyInvestment"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.yearlyInvestmentIncrease" | translate }}'
                               type="number"
                               formControlName="yearlyInvestmentIncrease"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.dividendReinvestmentPercentage" | translate }}'
                               type="number"
                               formControlName="dividendReinvestmentPercentage"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.initialDividendPercentage" | translate }}'
                               type="number"
                               formControlName="initialDividendPercentage"
                               min="0" max="100"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.yearlyDividendPercentageIncrease" | translate }}'
                               type="number"
                               formControlName="yearlyDividendPercentageIncrease"
                               min="0" max="100"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.taxPercentage" | translate }}'
                               type="number"
                               formControlName="taxPercentage"
                               min="0" max="100"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-input labelPlacement="stacked"
                               label='{{ "calculator.form.yearlyTaxFreeSum" | translate }}'
                               type="number"
                               formControlName="yearlyTaxFreeSum">
                    </ion-input>
                </ion-item>

                <ion-button (click)="doCalculate()">{{ "calculator.form.submit" | translate }}
                    <ion-icon slot="start" md="arrow-forward"></ion-icon>
                </ion-button>

            </form>
        </ion-card-content>
    </ion-card>


    <ion-card *ngIf="segment === 'results'">
        <ion-card-header>
            <ion-card-title>{{ "calculator.result-header" | translate }}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
            <ion-toggle [checked]="showStockColumns"
                        (click)="showStockColumns = !showStockColumns">{{ "calculator.result.stocksimul" | translate }}</ion-toggle>
            <br>
            <ion-grid>
                <ion-row class="tableHeader">

                    <ion-col>{{ "calculator.result.tblheader.col-1" | translate }}</ion-col>
                    <ion-col *ngIf="showStockColumns"
                        matTooltip="{{ 'calculator.result.tblheader.col-2-tt' | translate }}">
                        {{ "calculator.result.tblheader.col-2" | translate }}
                    </ion-col>
                    <ion-col *ngIf="showStockColumns">{{ "calculator.result.tblheader.col-3" | translate }}</ion-col>
                    <ion-col *ngIf="showStockColumns">{{ "calculator.result.tblheader.col-4" | translate }}</ion-col>
                    <ion-col *ngIf="showStockColumns">{{ "calculator.result.tblheader.col-5" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-6" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-7" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-8" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-9" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-10" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-11" | translate }}</ion-col>
                    <ion-col>{{ "calculator.result.tblheader.col-12" | translate }}</ion-col>
                    <ion-col class="priceGains">{{ "calculator.result.tblheader.col-13" | translate }}</ion-col>
                    <ion-col class="priceGains">{{ "calculator.result.tblheader.col-14" | translate }}</ion-col>
                </ion-row>
                <ng-container *ngFor="let elem of result; let y = index">
                    <ion-row [matTooltip]="contentRowTooltip(y)">
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            {{ currentYear + y }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}" *ngIf="showStockColumns">
                            {{ elem.shares.purchasePrice | number:'1.2-2':'de-DE' }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}" *ngIf="showStockColumns">
                            {{ elem.shares.averagePurchasePrice | number:'1.2-2':'de-DE' }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}" *ngIf="showStockColumns">
                            {{ elem.dividend.currentDividendPerShare | number:'1.2-2':'de-DE' }}â‚¬ /
                            {{ elem.kpis.dividendPercentage | number:'1.2-2':'de-DE' }}%
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}" *ngIf="showStockColumns">
                            {{ elem.kpis.accumulatedStockAmount | number:'1.2-2':'de-DE' }} /
                            {{ elem.shares.stockAmount | number:'1.2-2':'de-DE' }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            {{ elem.kpis.accumulatedPaymentsIncludingDividends | number:'1.2-2':'de-DE' }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.accumulatedPayments | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.investedSumPerYear | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.dividendPayout | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.dividendPayoutReinvested | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.yearlyAbsoluteDividendGrowth | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            <span *ngIf="y > 0">
                                {{ elem.kpis.yearlyInvestmentToReinvestedDividendFactor | number:'1.2-2':'de-DE' }}
                            </span>
                            <span *ngIf="y === 0">
                                -
                            </span>
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            {{ elem.kpis.accumulatedPriceGains | number:'1.2-2':'de-DE' }}
                        </ion-col>
                        <ion-col [ngClass]="{'baseRow': y === 0}">
                            {{ elem.kpis.accumulatedAssetsInclundingPriceGains | number:'1.2-2':'de-DE' }}
                        </ion-col>
                    </ion-row>
                </ng-container>
            </ion-grid>
        </ion-card-content>
    </ion-card>
</ion-content>
